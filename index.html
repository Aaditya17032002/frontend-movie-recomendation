<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Movie & TV Series Recommender</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Playfair+Display:wght@400;500;600&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --secondary: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            --accent: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            --bg-primary: #fafaff;
            --bg-secondary: #f5f7ff;
            --text-primary: #2d3748;
            --text-secondary: #718096;
            --card-bg: rgba(255, 255, 255, 0.8);
            --shadow: 0 20px 40px rgba(0, 0, 0, 0.05);
            --shadow-hover: 0 30px 60px rgba(0, 0, 0, 0.1);
            --border-radius: 20px;
            --pastel-pink: #fde2e7;
            --pastel-blue: #dbeafe;
            --pastel-purple: #e9d5ff;
            --pastel-green: #d1fae5;
            --pastel-yellow: #fef3c7;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: var(--text-primary);
            overflow-x: hidden;
        }

        .bg-pattern {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 20%, rgba(255, 255, 255, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(255, 255, 255, 0.1) 0%, transparent 50%);
            pointer-events: none;
            z-index: 0;
        }

        .container {
            position: relative;
            z-index: 1;
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
        }

        .header {
            text-align: center;
            margin-bottom: 3rem;
            animation: fadeInUp 1s ease-out;
        }

        .logo {
            font-family: 'Playfair Display', serif;
            font-size: 3.5rem;
            font-weight: 600;
            background: linear-gradient(135deg, #ffffff 0%, #f0f0f0 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 0.5rem;
            letter-spacing: -2px;
        }

        .tagline {
            color: rgba(255, 255, 255, 0.8);
            font-size: 1.2rem;
            font-weight: 300;
            margin-bottom: 2rem;
        }

        .main-card {
            background: var(--card-bg);
            backdrop-filter: blur(20px);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            padding: 3rem;
            margin-bottom: 2rem;
            border: 1px solid rgba(255, 255, 255, 0.2);
            animation: fadeInUp 1s ease-out 0.2s both;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .main-card:hover {
            box-shadow: var(--shadow-hover);
            transform: translateY(-5px);
        }

        .section-title {
            font-family: 'Playfair Display', serif;
            font-size: 2rem;
            font-weight: 500;
            margin-bottom: 1.5rem;
            color: var(--text-primary);
            position: relative;
        }

        .section-title::after {
            content: '';
            position: absolute;
            bottom: -5px;
            left: 0;
            width: 60px;
            height: 3px;
            background: var(--primary);
            border-radius: 2px;
        }

        .input-group {
            margin-bottom: 2rem;
        }

        .input-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: var(--text-primary);
        }

        .movie-input {
            position: relative;
            margin-bottom: 1rem;
        }

        .movie-input input {
            width: 100%;
            padding: 1rem 1.5rem;
            border: 2px solid transparent;
            border-radius: 15px;
            background: rgba(255, 255, 255, 0.9);
            font-size: 1rem;
            transition: all 0.3s ease;
            outline: none;
        }

        .movie-input input:focus {
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
            transform: scale(1.02);
        }

        .add-movie-btn {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.8rem 1.5rem;
            background: var(--accent);
            color: white;
            border: none;
            border-radius: 12px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 1rem;
        }

        .add-movie-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(79, 172, 254, 0.3);
        }

        .movie-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 0.75rem;
            margin-top: 1rem;
        }

        .movie-tag {
            padding: 0.5rem 1rem;
            background: var(--pastel-blue);
            color: var(--text-primary);
            border-radius: 25px;
            font-size: 0.9rem;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            animation: slideInScale 0.3s ease-out;
        }

        .remove-tag {
            cursor: pointer;
            width: 16px;
            height: 16px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            transition: background 0.2s ease;
        }

        .remove-tag:hover {
            background: rgba(0, 0, 0, 0.4);
        }

        .filters-grid {
            display: flex;
            gap: 2rem;
            margin: 2rem 0;
            flex-wrap: wrap;
            justify-content: space-between;
        }
        .filter-group {
            background: rgba(255, 255, 255, 0.7);
            padding: 2rem 1.5rem 1.5rem 1.5rem;
            border-radius: 20px;
            border: 1px solid rgba(102, 126, 234, 0.08);
            box-shadow: 0 4px 24px rgba(102, 126, 234, 0.07);
            min-width: 220px;
            flex: 1 1 220px;
            margin-bottom: 0;
            display: flex;
            flex-direction: column;
            align-items: flex-start;
            position: relative;
        }
        .filter-title {
            font-weight: 700;
            margin-bottom: 1.2rem;
            color: #4f4f6e;
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            gap: 0.7rem;
        }
        .filter-title .icon {
            font-size: 1.5rem;
            opacity: 0.8;
            margin-right: 0.3rem;
        }
        .genre-pills {
            display: flex;
            flex-wrap: wrap;
            gap: 0.7rem;
        }
        .genre-pill {
            padding: 0.5rem 1.2rem;
            border-radius: 999px;
            background: #f3f4fa;
            color: #4f4f6e;
            border: none;
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            box-shadow: 0 1px 4px rgba(102,126,234,0.04);
            transition: background 0.2s, color 0.2s, box-shadow 0.2s;
        }
        .genre-pill:hover, .genre-pill.active {
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            color: #fff;
            box-shadow: 0 2px 8px rgba(102,126,234,0.10);
        }
        .mood-selector {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
            margin-top: 0.5rem;
        }
        /* Custom radio buttons */
        .custom-radio-group {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            margin-top: 0.5rem;
        }
        .custom-radio {
            display: flex;
            align-items: center;
            gap: 0.7rem;
            font-size: 1rem;
            cursor: pointer;
            position: relative;
        }
        .custom-radio input[type="radio"] {
            appearance: none;
            width: 22px;
            height: 22px;
            border: 2px solid #667eea;
            border-radius: 50%;
            outline: none;
            background: #fff;
            transition: border 0.2s;
            margin-right: 0.5rem;
            position: relative;
        }
        .custom-radio input[type="radio"]:checked {
            border: 7px solid #667eea;
            background: #e9eafe;
        }
        .custom-radio input[type="radio"]:focus {
            box-shadow: 0 0 0 2px #a5b4fc;
        }
        .custom-radio:hover input[type="radio"] {
            border-color: #4f4f6e;
        }
        @media (max-width: 1100px) {
            .filters-grid {
                flex-direction: column;
                gap: 1.5rem;
            }
            .filter-group {
                min-width: unset;
                width: 100%;
            }
        }

        .cta-button {
            display: inline-flex;
            align-items: center;
            gap: 0.75rem;
            padding: 1.2rem 2.5rem;
            background: var(--secondary);
            color: white;
            border: none;
            border-radius: 15px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            margin: 2rem auto;
            display: block;
            position: relative;
            overflow: hidden;
        }

        .cta-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.6s ease;
        }

        .cta-button:hover::before {
            left: 100%;
        }

        .cta-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 35px rgba(245, 87, 108, 0.4);
        }

        .recommendations-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 2rem;
            margin-top: 2rem;
        }

        .movie-card {
            background: var(--card-bg);
            backdrop-filter: blur(10px);
            border-radius: var(--border-radius);
            padding: 2rem;
            box-shadow: var(--shadow);
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .movie-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--primary);
            transform: scaleX(0);
            transition: transform 0.3s ease;
        }

        .movie-card:hover::before {
            transform: scaleX(1);
        }

        .movie-card:hover {
            transform: translateY(-8px);
            box-shadow: var(--shadow-hover);
        }

        .movie-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 1rem;
        }

        .movie-title {
            font-family: 'Playfair Display', serif;
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 0.5rem;
        }

        .movie-year {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .rating-badge {
            background: var(--accent);
            color: white;
            padding: 0.3rem 0.8rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .movie-description {
            color: var(--text-secondary);
            line-height: 1.6;
            margin-bottom: 1.5rem;
        }

        .movie-tags-small {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }

        .tag-small {
            padding: 0.25rem 0.75rem;
            background: var(--pastel-blue);
            border-radius: 15px;
            font-size: 0.8rem;
            color: var(--text-primary);
        }

        .why-recommended {
            background: rgba(102, 126, 234, 0.1);
            padding: 1rem;
            border-radius: 12px;
            margin-top: 1rem;
            border-left: 4px solid #667eea;
        }

        .quick-actions {
            display: flex;
            gap: 1rem;
            margin-top: 1.5rem;
        }

        .action-btn {
            flex: 1;
            padding: 0.75rem;
            border: 2px solid #667eea;
            background: transparent;
            color: #667eea;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .action-btn:hover {
            background: #667eea;
            color: white;
            transform: translateY(-2px);
        }

        .floating-elements {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -1;
        }

        .floating-circle {
            position: absolute;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.05);
            animation: float 6s ease-in-out infinite;
        }

        .circle-1 { width: 80px; height: 80px; top: 20%; left: 10%; animation-delay: 0s; }
        .circle-2 { width: 120px; height: 120px; top: 60%; right: 15%; animation-delay: 2s; }
        .circle-3 { width: 60px; height: 60px; bottom: 20%; left: 20%; animation-delay: 4s; }

        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(180deg); }
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes slideInScale {
            from {
                opacity: 0;
                transform: scale(0.8) translateX(-20px);
            }
            to {
                opacity: 1;
                transform: scale(1) translateX(0);
            }
        }

        @media (max-width: 768px) {
            .container { padding: 1rem; }
            .main-card { padding: 2rem; }
            .logo { font-size: 2.5rem; }
            .filters-grid { grid-template-columns: 1fr; }
            .recommendations-grid { grid-template-columns: 1fr; }
        }

        .hidden { display: none; }
        .loading {
            text-align: center;
            padding: 3rem;
            color: var(--text-secondary);
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid rgba(102, 126, 234, 0.2);
            border-top: 4px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 1rem;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .modern-new-search {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.7rem;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            color: #fff !important;
            border: none !important;
            border-radius: 16px !important;
            font-weight: 600;
            font-size: 1.1rem;
            padding: 0.9rem 2.2rem;
            box-shadow: 0 4px 16px rgba(102, 126, 234, 0.15);
            transition: background 0.3s, box-shadow 0.3s, transform 0.2s;
            margin: 0 auto;
            max-width: 320px;
            width: 100%;
            margin-bottom: 1.5rem;
        }
        .modern-new-search:hover {
            background: linear-gradient(90deg, #f093fb 0%, #f5576c 100%);
            box-shadow: 0 8px 24px rgba(245, 87, 108, 0.15);
            color: #fff;
            transform: translateY(-2px) scale(1.03);
        }

        /* New styles */
        .loading-spinner {
            display: none;
            width: 40px;
            height: 40px;
            margin: 20px auto;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #007bff;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .success-message {
            display: none;
            color: #28a745;
            text-align: center;
            margin: 10px 0;
            padding: 10px;
            background: #d4edda;
            border-radius: 4px;
        }

        .clear-all {
            background: #6c757d;
            margin-left: 10px;
        }

        .clear-all:hover {
            background: #5a6268;
        }

        .new-search {
            background: #28a745;
            margin-top: 20px;
        }

        .new-search:hover {
            background: #218838;
        }

        .input-section {
            position: relative;
        }

        .input-section .success-icon {
            position: absolute;
            right: 120px;
            top: 50%;
            transform: translateY(-50%);
            color: #28a745;
            display: none;
        }

        .recommendation-card {
            position: relative;
        }

        .recommendation-card .rating {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 14px;
        }

        .recommendation-card .year {
            position: absolute;
            top: 10px;
            left: 10px;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 14px;
        }

        .no-results {
            text-align: center;
            padding: 20px;
            color: #666;
            display: none;
        }

        @media (max-width: 600px) {
            .modern-new-search {
                font-size: 1rem;
                padding: 0.8rem 1.2rem;
                max-width: 95vw;
            }
            .filter-title {
                font-size: 1rem;
            }
            .genre-pill {
                font-size: 0.95rem;
                padding: 0.4rem 1rem;
            }
        }

        .nav-tabs {
            display: flex;
            gap: 18px;
            justify-content: center;
            margin-bottom: 2.5rem;
            background: none;
            border: none;
        }

        .nav-tabs button {
            background: none;
            border: none;
            outline: none;
            font-family: 'Inter', sans-serif;
            font-size: 1.15rem;
            font-weight: 500;
            color: #4f4f6e;
            opacity: 1;
            padding: 0.7rem 2.2rem 0.7rem 2.2rem;
            border-radius: 999px;
            transition: background 0.2s, color 0.2s, box-shadow 0.2s;
            cursor: pointer;
            position: relative;
            box-shadow: none;
            letter-spacing: 0.5px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .nav-tabs button .tab-icon {
            margin-right: 0.7em;
            font-size: 1.2em;
            display: inline-block;
            filter: none;
        }

        .nav-tabs button.active,
        .nav-tabs button:hover {
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            color: #fff;
            box-shadow: 0 4px 16px rgba(102, 126, 234, 0.10);
            font-weight: 600;
        }

        .nav-tabs button.active::after {
            content: '';
            display: block;
            position: absolute;
            left: 30%;
            right: 30%;
            bottom: 7px;
            height: 3px;
            border-radius: 2px;
            background: #fff;
            opacity: 0.8;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            z-index: 2;
        }

        @media (max-width: 600px) {
            .nav-tabs {
                flex-direction: column;
                gap: 10px;
            }
            .nav-tabs button {
                width: 100%;
                text-align: center;
            }
            .nav-tabs button.active::after {
                left: 20%;
                right: 20%;
            }
        }
    </style>
</head>
<body>
    <div class="bg-pattern"></div>
    <div class="floating-elements">
        <div class="floating-circle circle-1"></div>
        <div class="floating-circle circle-2"></div>
        <div class="floating-circle circle-3"></div>
    </div>

    <div class="container">
        <header class="header">
            <h1 class="logo">CineMatch</h1>
            <p class="tagline">Discover your next favorite movie with AI-powered recommendations</p>
        </header>

        <!-- Navigation Tabs -->
        <div class="nav-tabs">
            <button id="tab-recommendations" class="active"><span class="tab-icon">üé¨</span>Recommendations</button>
            <button id="tab-watchlist"><span class="tab-icon">‚≠ê</span>Watchlist</button>
            <button id="tab-watched"><span class="tab-icon">‚úÖ</span>Watched</button>
        </div>

        <!-- Main Content Sections -->
        <div id="inputSection" class="main-card">
            <h2 class="section-title">Tell us what you love</h2>
            
            <div class="input-group">
                <label class="input-label">Add movies you enjoyed</label>
                <div class="movie-input">
                    <input type="text" id="movieInput" placeholder="Search for a movie..." autocomplete="off">
                </div>
                <button class="add-movie-btn" id="addMovieBtn">
                    <span>‚ú®</span> Get Recommendations
                </button>
                <div class="movie-tags" id="movieTags"></div>
            </div>

            <div class="filters-grid">
                <div class="filter-group">
                    <div class="filter-title"><span class="icon">üé¨</span> Favorite Genres</div>
                    <div class="genre-pills" id="genrePills">
                        <!-- Genres will be populated dynamically -->
                    </div>
                </div>

                <div class="filter-group">
                    <div class="filter-title"><span class="icon">üòä</span> Current Mood</div>
                    <div class="mood-selector" id="moodSelector">
                        <!-- Moods will be populated dynamically -->
                    </div>
                </div>

                <!-- Content Type Filter -->
                <div class="filter-group">
                    <div class="filter-title"><span class="icon">üéûÔ∏è</span> Content Type</div>
                    <div class="custom-radio-group">
                        <label class="custom-radio"><input type="radio" name="contentType" value="" checked> All</label>
                        <label class="custom-radio"><input type="radio" name="contentType" value="movies"> Movies Only</label>
                        <label class="custom-radio"><input type="radio" name="contentType" value="tv_series"> TV Series Only</label>
                    </div>
                </div>
                <!-- Region Filter -->
                <div class="filter-group">
                    <div class="filter-title"><span class="icon">üåè</span> Region</div>
                    <div class="custom-radio-group">
                        <label class="custom-radio"><input type="radio" name="region" value="" checked> All</label>
                        <label class="custom-radio"><input type="radio" name="region" value="hollywood"> Hollywood</label>
                        <label class="custom-radio"><input type="radio" name="region" value="bollywood"> Bollywood</label>
                    </div>
                </div>
            </div>
        </div>

        <div id="loadingSection" class="main-card hidden">
            <div class="loading">
                <div class="spinner"></div>
                <h3>Analyzing your taste...</h3>
                <p>Our AI is finding perfect matches for you</p>
            </div>
        </div>

        <div id="recommendationsSection" class="main-card hidden">
            <div class="section-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
                <h2 class="section-title">Your Personalized Recommendations</h2>
                <button class="modern-new-search" onclick="app.resetSearch()">
                    <span style="font-size:1.3em;">üîÑ</span> <span>New Search</span>
                </button>
            </div>
            <div class="recommendations-grid" id="recommendationsGrid">
                <!-- Recommendations will be populated here -->
            </div>
            <button class="cta-button" id="getMoreRecs">
                <span>üîÑ</span> Get More Recommendations
            </button>
        </div>
        <div id="watchlistSection" class="main-card hidden">
            <h2 class="section-title">My Watchlist</h2>
            <div class="recommendations-grid" id="watchlistGrid"></div>
        </div>
        <div id="watchedSection" class="main-card hidden">
            <h2 class="section-title">Already Watched</h2>
            <div class="recommendations-grid" id="watchedGrid"></div>
        </div>
    </div>

    <script>
        class CineMatch {
            constructor() {
                this.selectedMovies = [];
                this.selectedGenres = [];
                this.selectedMood = null;
                this.currentPage = 1;
                this.shownMovies = JSON.parse(localStorage.getItem('shownMovies') || '[]');
                this.API_URL = 'https://backend-movie-recomendation.vercel.app';
                this.genres = [
                    "Action", "Adventure", "Animation", "Comedy", "Crime", "Documentary",
                    "Drama", "Family", "Fantasy", "Horror", "Mystery", "Romance",
                    "Sci-Fi", "Thriller", "War", "Western"
                ];
                this.moods = [
                    { id: "feel-good", emoji: "üòä", label: "Feel Good" },
                    { id: "suspenseful", emoji: "üò∞", label: "Suspenseful" },
                    { id: "mind-bending", emoji: "ü§Ø", label: "Mind-Bending" },
                    { id: "romantic", emoji: "üíï", label: "Romantic" },
                    { id: "inspiring", emoji: "üåü", label: "Inspiring" },
                    { id: "funny", emoji: "üòÇ", label: "Funny" },
                    { id: "emotional", emoji: "ü•π", label: "Emotional" },
                    { id: "adventurous", emoji: "üèÉ", label: "Adventurous" }
                ];
                this.watchlist = JSON.parse(localStorage.getItem('watchlist') || '[]');
                this.watched = JSON.parse(localStorage.getItem('watched') || '[]');
                this.activeTab = 'recommendations';
                this.init();
            }

            init() {
                this.bindEvents();
                this.setupMockData();
                this.initializeGenres();
                this.initializeMoods();
            }

            initializeGenres() {
                const container = document.getElementById('genrePills');
                container.innerHTML = this.genres.map(genre => `
                    <button class="genre-pill" data-genre="${genre.toLowerCase()}">${genre}</button>
                `).join('');

                // Add event listeners to genre pills
                container.querySelectorAll('.genre-pill').forEach(pill => {
                    pill.addEventListener('click', () => this.toggleGenre(pill));
                });
            }

            initializeMoods() {
                const container = document.getElementById('moodSelector');
                container.innerHTML = this.moods.map(mood => `
                    <div class="mood-option ${mood.id}" data-mood="${mood.id}">
                        <div style="font-size: 1.5rem; margin-bottom: 0.5rem;">${mood.emoji}</div>
                        <div>${mood.label}</div>
                    </div>
                `).join('');

                // Add event listeners to mood options
                container.querySelectorAll('.mood-option').forEach(option => {
                    option.addEventListener('click', () => this.selectMood(option));
                });
            }

            bindEvents() {
                const movieInput = document.getElementById('movieInput');
                const addMovieBtn = document.getElementById('addMovieBtn');
                const getMoreBtn = document.getElementById('getMoreRecs');
                const newSearchBtn = document.querySelector('.section-header .action-btn');

                movieInput.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') this.addMovie();
                });

                addMovieBtn.addEventListener('click', () => this.getRecommendations(true));
                getMoreBtn.addEventListener('click', () => this.getMoreRecommendations());
                if (newSearchBtn) {
                    newSearchBtn.classList.add('modern-new-search');
                }
                document.getElementById('tab-recommendations').onclick = () => this.switchTab('recommendations');
                document.getElementById('tab-watchlist').onclick = () => this.switchTab('watchlist');
                document.getElementById('tab-watched').onclick = () => this.switchTab('watched');
            }

            addMovie() {
                const input = document.getElementById('movieInput');
                const movieTitle = input.value.trim();
                if (movieTitle && !this.selectedMovies.includes(movieTitle)) {
                    this.selectedMovies.push(movieTitle);
                    this.renderMovieTags();
                    input.value = '';
                    input.style.transform = 'scale(0.95)';
                    setTimeout(() => input.style.transform = 'scale(1)', 150);
                }
            }

            removeMovie(movie) {
                this.selectedMovies = this.selectedMovies.filter(m => m !== movie);
                this.renderMovieTags();
            }

            renderMovieTags() {
                const container = document.getElementById('movieTags');
                container.innerHTML = this.selectedMovies.map(movie => `
                    <div class="movie-tag">
                        ${movie}
                        <span class="remove-tag" onclick="app.removeMovie('${movie}')">√ó</span>
                    </div>
                `).join('');
            }

            toggleGenre(pill) {
                const genre = pill.dataset.genre;
                pill.classList.toggle('active');
                
                if (this.selectedGenres.includes(genre)) {
                    this.selectedGenres = this.selectedGenres.filter(g => g !== genre);
                } else {
                    this.selectedGenres.push(genre);
                }
            }

            selectMood(option) {
                document.querySelectorAll('.mood-option').forEach(opt => opt.classList.remove('active'));
                option.classList.add('active');
                this.selectedMood = option.dataset.mood;
            }

            async getRecommendations(autoAddInput = false) {
                const input = document.getElementById('movieInput');
                const movieTitle = input.value.trim();
                if (autoAddInput && movieTitle && !this.selectedMovies.includes(movieTitle)) {
                    this.selectedMovies.push(movieTitle);
                    this.renderMovieTags();
                    input.value = '';
                }
                if (this.selectedMovies.length < 1) {
                    alert('Please add at least one movie you enjoyed!');
                    return;
                }
                this.currentPage = 1;
                this.shownMovies = [];
                localStorage.setItem('shownMovies', JSON.stringify([]));
                await this.fetchRecommendations();
            }

            async getMoreRecommendations() {
                this.currentPage++;
                await this.fetchRecommendations(true);
            }

            async fetchRecommendations(append = false) {
                document.getElementById('inputSection').classList.add('hidden');
                document.getElementById('recommendationsSection').classList.add('hidden');
                document.getElementById('loadingSection').classList.remove('hidden');
                try {
                    const contentType = document.querySelector('input[name="contentType"]:checked')?.value || '';
                    const region = document.querySelector('input[name="region"]:checked')?.value || '';
                    const response = await fetch(`${this.API_URL}/api/recommend`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            likedMovies: this.selectedMovies,
                            preferences: {
                                genres: this.selectedGenres,
                                language: 'English',
                                mood: this.selectedMood,
                                page: this.currentPage,
                                contentType,
                                region
                            },
                            alreadyRecommended: this.shownMovies
                        })
                    });
                    if (!response.ok) {
                        throw new Error('Failed to get recommendations');
                    }
                    const data = await response.json();
                    // Filter out duplicates
                    const newRecs = data.recommendations.filter(
                        rec => !this.shownMovies.includes(rec.title)
                    );
                    // Update shownMovies
                    this.shownMovies = [...this.shownMovies, ...newRecs.map(r => r.title)];
                    localStorage.setItem('shownMovies', JSON.stringify(this.shownMovies));
                    if (append) {
                        const existingGrid = document.getElementById('recommendationsGrid');
                        const newRecommendations = this.renderRecommendationCards(newRecs);
                        existingGrid.insertAdjacentHTML('beforeend', newRecommendations);
                    } else {
                        this.renderRecommendations(newRecs);
                    }
                    document.getElementById('loadingSection').classList.add('hidden');
                    document.getElementById('recommendationsSection').classList.remove('hidden');
                } catch (error) {
                    console.error('Error:', error);
                    alert('Failed to get recommendations. Please try again.');
                    document.getElementById('loadingSection').classList.add('hidden');
                    document.getElementById('inputSection').classList.remove('hidden');
                }
            }

            renderRecommendationCards(recommendations) {
                return recommendations.map(movie => `
                    <div class="movie-card">
                        <div class="movie-header">
                            <div>
                                <h3 class="movie-title">${movie.title}</h3>
                                <div class="movie-year">${movie.tmdb_data?.release_date?.split('-')[0] || 'N/A'}</div>
                            </div>
                            <div class="rating-badge">${movie.omdb_data?.imdb_rating || 'N/A'}</div>
                        </div>
                        ${movie.poster_url ? `
                            <img src="${movie.poster_url}" alt="${movie.title}" style="
                                width: 100%;
                                height: auto;
                                border-radius: 10px;
                                margin-bottom: 1rem;
                            ">
                        ` : ''}
                        <p class="movie-description">${movie.omdb_data?.plot || movie.reasoning}</p>
                        <div class="movie-tags-small">
                            ${movie.genres.map(genre => `<span class="tag-small">${genre}</span>`).join('')}
                        </div>
                        ${movie.tmdb_data?.cast?.length ? `
                            <div class="cast-info" style="margin-top: 1rem;">
                                <strong>Cast:</strong> ${movie.tmdb_data.cast.map(actor => 
                                    `${actor.name} (${actor.character})`
                                ).join(', ')}
                            </div>
                        ` : ''}
                        <div class="why-recommended">
                            <strong>Why this matches:</strong> ${movie.reasoning}
                        </div>
                        <div class="quick-actions">
                            <button class="action-btn" onclick="app.addToWatchlist(${JSON.stringify(movie).replace(/"/g, '&quot;')})">Add to Watchlist</button>
                            <button class="action-btn" onclick="app.markAsWatched(${JSON.stringify(movie).replace(/"/g, '&quot;')})">Mark as Watched</button>
                        </div>
                    </div>
                `).join('');
            }

            renderRecommendations(recommendations) {
                const grid = document.getElementById('recommendationsGrid');
                grid.innerHTML = this.renderRecommendationCards(recommendations);
            }

            resetSearch() {
                this.selectedMovies = [];
                this.selectedGenres = [];
                this.selectedMood = null;
                this.currentPage = 1;
                this.shownMovies = [];
                localStorage.setItem('shownMovies', JSON.stringify([]));
                document.getElementById('movieTags').innerHTML = '';
                document.getElementById('movieInput').value = '';
                document.querySelectorAll('.genre-pill').forEach(pill => pill.classList.remove('active'));
                document.querySelectorAll('.mood-option').forEach(opt => opt.classList.remove('active'));
                document.getElementById('recommendationsSection').classList.add('hidden');
                document.getElementById('inputSection').classList.remove('hidden');
            }

            setupMockData() {
                // Add some visual enhancements
                this.addParticleEffects();
            }

            addParticleEffects() {
                // Create subtle floating particles for extra ambiance
                const particles = document.querySelector('.floating-elements');
                for (let i = 0; i < 5; i++) {
                    const particle = document.createElement('div');
                    particle.className = 'floating-circle';
                    particle.style.width = Math.random() * 40 + 20 + 'px';
                    particle.style.height = particle.style.width;
                    particle.style.left = Math.random() * 100 + '%';
                    particle.style.top = Math.random() * 100 + '%';
                    particle.style.animationDelay = Math.random() * 6 + 's';
                    particle.style.animationDuration = (Math.random() * 4 + 4) + 's';
                    particles.appendChild(particle);
                }
            }

            switchTab(tab) {
                this.activeTab = tab;
                document.getElementById('tab-recommendations').classList.remove('active');
                document.getElementById('tab-watchlist').classList.remove('active');
                document.getElementById('tab-watched').classList.remove('active');
                document.getElementById('recommendationsSection').classList.add('hidden');
                document.getElementById('watchlistSection').classList.add('hidden');
                document.getElementById('watchedSection').classList.add('hidden');
                if (tab === 'recommendations') {
                    document.getElementById('tab-recommendations').classList.add('active');
                    document.getElementById('recommendationsSection').classList.remove('hidden');
                } else if (tab === 'watchlist') {
                    document.getElementById('tab-watchlist').classList.add('active');
                    document.getElementById('watchlistSection').classList.remove('hidden');
                    this.renderWatchlist();
                } else if (tab === 'watched') {
                    document.getElementById('tab-watched').classList.add('active');
                    document.getElementById('watchedSection').classList.remove('hidden');
                    this.renderWatched();
                }
            }

            addToWatchlist(movie) {
                if (!this.watchlist.some(m => m.title === movie.title)) {
                    this.watchlist.push(movie);
                    localStorage.setItem('watchlist', JSON.stringify(this.watchlist));
                    this.renderWatchlist();
                    alert('Added to watchlist!');
                }
            }

            markAsWatched(movie) {
                if (!this.watched.some(m => m.title === movie.title)) {
                    this.watched.push(movie);
                    localStorage.setItem('watched', JSON.stringify(this.watched));
                    // Remove from watchlist if present
                    this.watchlist = this.watchlist.filter(m => m.title !== movie.title);
                    localStorage.setItem('watchlist', JSON.stringify(this.watchlist));
                    this.renderWatchlist();
                    this.renderWatched();
                    alert('Marked as watched!');
                }
            }

            renderWatchlist() {
                const grid = document.getElementById('watchlistGrid');
                if (!this.watchlist.length) {
                    grid.innerHTML = '<div style="text-align:center;">Your watchlist is empty.</div>';
                    return;
                }
                grid.innerHTML = this.watchlist.map(movie => `
                    <div class="movie-card">
                        ${movie.poster_url ? `<img src="${movie.poster_url}" alt="${movie.title}" style="width:100%;height:auto;border-radius:10px;margin-bottom:1rem;">` : ''}
                        <h4>${movie.title}</h4>
                        <div class="movie-actions">
                            <button onclick="app.markAsWatched(${JSON.stringify(movie).replace(/"/g, '&quot;')})">Mark as Watched</button>
                        </div>
                    </div>
                `).join('');
            }

            renderWatched() {
                const grid = document.getElementById('watchedGrid');
                if (!this.watched.length) {
                    grid.innerHTML = '<div style="text-align:center;">No watched movies yet.</div>';
                    return;
                }
                grid.innerHTML = this.watched.map(movie => `
                    <div class="movie-card">
                        ${movie.poster_url ? `<img src="${movie.poster_url}" alt="${movie.title}" style="width:100%;height:auto;border-radius:10px;margin-bottom:1rem;">` : ''}
                        <h4>${movie.title}</h4>
                    </div>
                `).join('');
            }
        }

        // Initialize the app
        const app = new CineMatch();

        // Add some interactive polish
        document.addEventListener('DOMContentLoaded', () => {
            // Smooth scrolling for better UX
            document.documentElement.style.scrollBehavior = 'smooth';
            
            // Add click ripple effects to buttons
            document.querySelectorAll('button').forEach(button => {
                button.addEventListener('click', function(e) {
                    const ripple = document.createElement('span');
                    const rect = this.getBoundingClientRect();
                    const size = Math.max(rect.width, rect.height);
                    const x = e.clientX - rect.left - size / 2;
                    const y = e.clientY - rect.top - size / 2;
                    
                    ripple.style.cssText = `
                        position: absolute;
                        width: ${size}px;
                        height: ${size}px;
                        left: ${x}px;
                        top: ${y}px;
                        background: rgba(255, 255, 255, 0.3);
                        border-radius: 50%;
                        transform: scale(0);
                        animation: ripple 0.6s linear;
                        pointer-events: none;
                    `;
                    
                    this.style.position = 'relative';
                    this.style.overflow = 'hidden';
                    this.appendChild(ripple);
                    
                    setTimeout(() => ripple.remove(), 600);
                });
            });
            
            // Add CSS for ripple animation
            const style = document.createElement('style');
            style.textContent = `
                @keyframes ripple {
                    to {
                        transform: scale(4);
                        opacity: 0;
                    }
                }
                
                .parallax-scroll {
                    transform: translateY(0);
                    transition: transform 0.1s ease-out;
                }
            `;
            document.head.appendChild(style);
            
            // Add parallax effect to floating elements
            window.addEventListener('scroll', () => {
                const scrolled = window.pageYOffset;
                const parallax = document.querySelectorAll('.floating-circle');
                const speed = 0.5;
                
                parallax.forEach(element => {
                    element.style.transform = `translateY(${scrolled * speed}px)`;
                });
            });
            
            // Add intersection observer for scroll animations
            const observerOptions = {
                threshold: 0.1,
                rootMargin: '0px 0px -50px 0px'
            };
            
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.style.animation = 'fadeInUp 0.6s ease-out forwards';
                    }
                });
            }, observerOptions);
            
            // Observe all cards for scroll animations
            document.querySelectorAll('.movie-card, .filter-group').forEach(card => {
                observer.observe(card);
            });
        });
        
        // Advanced movie search functionality with mock autocomplete
        class MovieSearch {
            constructor() {
                this.movieDatabase = [
                    'The Shawshank Redemption', 'The Godfather', 'The Dark Knight', 'Pulp Fiction',
                    'The Lord of the Rings: The Return of the King', 'Forrest Gump', 'Star Wars: Episode V',
                    'Inception', 'The Lord of the Rings: The Fellowship of the Ring', 'Goodfellas',
                    'The Matrix', 'Seven', 'The Lord of the Rings: The Two Towers', 'Star Wars: Episode IV',
                    'City of God', 'Casablanca', 'The Usual Suspects', 'Silence of the Lambs',
                    'Once Upon a Time in the West', 'Raiders of the Lost Ark', 'Rear Window',
                    'Psycho', 'The Green Mile', 'Memento', 'Apocalypse Now', 'Alien', 'Sunset Boulevard',
                    'Dr. Strangelove', 'Citizen Kane', 'North by Northwest', 'Vertigo', 'Taxi Driver',
                    'La Dolce Vita', '2001: A Space Odyssey', 'The Pianist', 'Parasite', 'Whiplash',
                    'The Prestige', 'Gladiator', 'The Departed', 'Back to the Future', 'American Beauty',
                    'The Grand Budapest Hotel', 'Arrival', 'Her', 'Mad Max: Fury Road', 'Moonlight',
                    'La La Land', 'Blade Runner 2049', 'Get Out', 'The Shape of Water', 'Three Billboards'
                ];
                this.initAutocomplete();
            }
            
            initAutocomplete() {
                const input = document.getElementById('movieInput');
                const suggestionsContainer = this.createSuggestionsContainer();
                
                input.addEventListener('input', (e) => {
                    const query = e.target.value.toLowerCase();
                    if (query.length > 1) {
                        const matches = this.movieDatabase.filter(movie => 
                            movie.toLowerCase().includes(query)
                        ).slice(0, 5);
                        
                        this.showSuggestions(matches, suggestionsContainer, input);
                    } else {
                        this.hideSuggestions(suggestionsContainer);
                    }
                });
                
                // Hide suggestions when clicking outside
                document.addEventListener('click', (e) => {
                    if (!input.contains(e.target) && !suggestionsContainer.contains(e.target)) {
                        this.hideSuggestions(suggestionsContainer);
                    }
                });
            }
            
            createSuggestionsContainer() {
                const container = document.createElement('div');
                container.className = 'autocomplete-suggestions';
                container.style.cssText = `
                    position: absolute;
                    top: 100%;
                    left: 0;
                    right: 0;
                    background: white;
                    border-radius: 0 0 15px 15px;
                    box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
                    z-index: 1000;
                    max-height: 200px;
                    overflow-y: auto;
                    display: none;
                `;
                
                document.querySelector('.movie-input').appendChild(container);
                return container;
            }
            
            showSuggestions(matches, container, input) {
                if (matches.length === 0) {
                    this.hideSuggestions(container);
                    return;
                }
                
                container.innerHTML = matches.map(movie => `
                    <div class="suggestion-item" style="
                        padding: 1rem;
                        cursor: pointer;
                        border-bottom: 1px solid #f0f0f0;
                        transition: background 0.2s ease;
                    " onmouseover="this.style.background='#f8f9ff'" 
                       onmouseout="this.style.background='white'"
                       onclick="app.selectMovieFromSuggestion('${movie}')">
                        ${movie}
                    </div>
                `).join('');
                
                container.style.display = 'block';
                container.style.animation = 'fadeInUp 0.3s ease-out';
            }
            
            hideSuggestions(container) {
                container.style.display = 'none';
            }
        }
        
        // Enhanced CineMatch with autocomplete
        app.selectMovieFromSuggestion = function(movie) {
            document.getElementById('movieInput').value = movie;
            this.addMovie();
            document.querySelector('.autocomplete-suggestions').style.display = 'none';
        };
        
        // Initialize movie search
        new MovieSearch();
        
        // Add some advanced visual effects
        class VisualEffects {
            constructor() {
                this.initMouseTracker();
                this.initScrollEffects();
            }
            
            initMouseTracker() {
                let mouseX = 0;
                let mouseY = 0;
                
                document.addEventListener('mousemove', (e) => {
                    mouseX = e.clientX;
                    mouseY = e.clientY;
                    
                    // Create subtle mouse trail effect
                    this.createMouseTrail(mouseX, mouseY);
                });
            }
            
            createMouseTrail(x, y) {
                const trail = document.createElement('div');
                trail.style.cssText = `
                    position: fixed;
                    left: ${x}px;
                    top: ${y}px;
                    width: 6px;
                    height: 6px;
                    background: rgba(102, 126, 234, 0.3);
                    border-radius: 50%;
                    pointer-events: none;
                    z-index: 9999;
                    animation: trailFade 0.8s ease-out forwards;
                `;
                
                document.body.appendChild(trail);
                setTimeout(() => trail.remove(), 800);
            }
            
            initScrollEffects() {
                const style = document.createElement('style');
                style.textContent += `
                    @keyframes trailFade {
                        0% {
                            transform: scale(1);
                            opacity: 1;
                        }
                        100% {
                            transform: scale(0);
                            opacity: 0;
                        }
                    }
                    
                    .movie-card {
                        transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
                    }
                    
                    .movie-card:hover .movie-title {
                        color: #667eea;
                        transition: color 0.3s ease;
                    }
                    
                    .genre-pill:active {
                        transform: scale(0.95);
                    }
                    
                    .mood-option:active {
                        transform: scale(0.98);
                    }
                `;
                document.head.appendChild(style);
            }
        }
        
        // Initialize visual effects
        new VisualEffects();
        
        // Add keyboard shortcuts for power users
        document.addEventListener('keydown', (e) => {
            // Ctrl/Cmd + Enter to get recommendations
            if ((e.ctrlKey || e.metaKey) && e.key === 'Enter') {
                e.preventDefault();
                document.getElementById('getRecommendations').click();
            }
            
            // Escape to clear current input
            if (e.key === 'Escape') {
                document.getElementById('movieInput').value = '';
                document.querySelector('.autocomplete-suggestions').style.display = 'none';
            }
        });
        
        // Performance optimization: Debounce resize events
        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }
        
        window.addEventListener('resize', debounce(() => {
            // Recalculate layouts if needed
            console.log('Window resized - layouts updated');
        }, 250));
    </script>
</body>
</html>